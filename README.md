# test-question ‚Äî –∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

## üöÄ –ó–∞–ø—É—Å–∫
```bash
docker compose up --build
```

## üîß –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫
```bash
make deps       # —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å goose, mockery, golangci-lint
make run        # go run ./cmd/api
```

## üß™ –¢–µ—Å—Ç—ã
```bash
make test             # —é–Ω–∏—Ç
make test-integration #–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ
make test-e2e         #e2e
make ci               # –ª–∏–Ω—Ç–µ—Ä + –≤—Å–µ —Ç–µ—Å—Ç—ã
```

## üì° HTTP-—Ç–µ—Å—Ç—ã (JetBrains)
–û—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª: requests_local.http\
–ù–∞–∂–∞—Ç—å ‚ñ∂ Run —Ä—è–¥–æ–º —Å –∑–∞–ø—Ä–æ—Å–æ–º.\
JetBrains –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç {{variables}}.
![img](docs/img/http_tests.png)
![img](docs/img/http_tests_result.png)

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å—Ö–µ–º–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏:

1. **OS ENV** ‚Äî –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã  
   –°–∞–º—ã–π –≤—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç. –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –ø—Ä–æ–¥–µ, CI/CD, –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö.

2. **.env.local** ‚Äî –ª–æ–∫–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞  
   –ù–µ –∫–æ–º–º–∏—Ç–∏—Ç—Å—è. –ü–æ–∑–≤–æ–ª—è–µ—Ç –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ `.env` –±–µ–∑ –≤–ª–∏—è–Ω–∏—è –Ω–∞ –¥—Ä—É–≥–∏—Ö.

3. **.env** ‚Äî –±–∞–∑–æ–≤—ã–π –∫–æ–Ω—Ñ–∏–≥ –ø—Ä–æ–µ–∫—Ç–∞  
   –î–µ—Ñ–æ–ª—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞, docker-compose, e2e-—Ç–µ—Å—Ç–æ–≤.

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** `OS ENV` ‚Üí `.env.local` ‚Üí `.env`

–í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (OS ENV); `.env` –∏ `.env.local` –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.

### –§–æ—Ä–º–∞—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–≤–∞ —Ñ–æ—Ä–º–∞—Ç–∞ –ª–æ–≥–æ–≤:

- **–¢–µ–∫—Å—Ç–æ–≤—ã–π (human-friendly)** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ.  
  –£–¥–æ–±–Ω–æ —á–∏—Ç–∞—Ç—å –ø—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ: —Ü–≤–µ—Ç–Ω—ã–µ –ª–æ–≥–∏, –∫—Ä–∞—Ç–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è.

- **JSON** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ.  
  –ú–∞—à–∏–Ω–æ—á–∏—Ç–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç, —Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π —Å ELK, Loki, ClickHouse-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º, Kubernetes-–∞–≥–µ–Ω—Ç–∞–º–∏ –∏ –ª—é–±—ã–º –ª–æ–≥-–∞–≥—Ä–µ–≥–∞—Ç–æ—Ä–æ–º.

–í—ã–±–æ—Ä —Ñ–æ—Ä–º–∞—Ç–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è ‚Äî –ª–æ–∫–∞–ª—å–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á–∞–µ—Ç—Å—è —á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º—ã–π –≤—ã–≤–æ–¥, –≤ –ø—Ä–æ–¥–µ –≤—Å–µ–≥–¥–∞ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JSON-–ª–æ–≥ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏.

### –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (`LOG_LEVEL`)

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ `slog`:

- **debug** ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø–æ–¥—Ä–æ–±–Ω—ã–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è  
  (SQL-–∑–∞–ø—Ä–æ—Å—ã, –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è use-case‚Äô–æ–≤).  
  –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ.

- **info** ‚Äî —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.  
  –û—Ç—Ä–∞–∂–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: —É—Å–ø–µ—à–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã, —Å—Ç–∞—Ä—Ç —Å–µ—Ä–≤–µ—Ä–∞, –º–∏–≥—Ä–∞—Ü–∏–∏.

- **warn** ‚Äî –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ, –Ω–æ –¥–æ–ø—É—Å—Ç–∏–º—ã–µ —Å–∏—Ç—É–∞—Ü–∏–∏: –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞, —Ä–µ—Ç—Ä–∞–∏, –º–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã.

- **error** ‚Äî –æ—à–∏–±–∫–∏, –ø–æ—Å–ª–µ –∫–æ—Ç–æ—Ä—ã—Ö –∑–∞–ø—Ä–æ—Å –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω.  
  –í—Å–µ `http 5xx` –ø–æ–ø–∞–¥–∞—é—Ç —Å—é–¥–∞.

–£—Ä–æ–≤–µ–Ω—å –∑–∞–¥–∞—ë—Ç—Å—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è: `LOG_LEVEL`

---

### –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è GORM (`LOG_LEVEL_GORM`)

GORM –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è SQL-–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.
–ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è **`LOG_LEVEL_GORM`** —É–ø—Ä–∞–≤–ª—è–µ—Ç —Ç–µ–º, –∫–∞–∫–∏–µ SQL-—Å–æ–±—ã—Ç–∏—è –≤—ã–≤–æ–¥—è—Ç—Å—è:

* **silent** ‚Äî –ø–æ–ª–Ω–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –ª–æ–≥–æ–≤ GORM
  (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ —Å –≤–Ω–µ—à–Ω–∏–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º SQL).

* **error** ‚Äî –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ SQL-–æ—à–∏–±–∫–∏
  (–Ω–∞–ø—Ä–∏–º–µ—Ä: –æ—à–∏–±–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è, –Ω–∞—Ä—É—à–µ–Ω–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è, –ø—Ä–æ–±–ª–µ–º—ã —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π).
  –£—Ä–æ–≤–µ–Ω—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.

* **warn** ‚Äî –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
  (–º–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã, –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã, –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ SQL-–ø–∞—Ç—Ç–µ—Ä–Ω—ã).

* **info** ‚Äî –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã
  (–∫–∞–∂–¥—ã–π SQL c –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏, –≤—Ä–µ–º–µ–Ω–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è; –ø–æ–¥—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏).

–ü—Ä–∏–º–µ—Ä –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

```env
LOG_LEVEL_GORM=warn
```

#### –ß—Ç–æ –∏–º–µ–Ω–Ω–æ –ª–æ–≥–∏—Ä—É–µ—Ç GORM

* **info**:
  `SELECT`, `INSERT`, `UPDATE`, `DELETE`, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

* **warn**:
  –º–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (`>200ms`), –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã –∑–∞–ø—Ä–æ—Å–æ–≤.

* **error**:
  –æ—à–∏–±–∫–∏ SQL, –æ—à–∏–±–∫–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π, –æ—à–∏–±–∫–∏ –¥—Ä–∞–π–≤–µ—Ä–∞.

* **silent**:
  GORM –Ω–∏–∫–∞–∫ –Ω–µ –∑–∞—Å–æ—Ä—è–µ—Ç –≤—ã–≤–æ–¥.


# üü™ **–ü—Ä–æ–µ–∫—Ç: Questions & Answers API (–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ)**

–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –º–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω–æ–µ, –Ω–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ REST API-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å—É—â–Ω–æ—Å—Ç—è–º–∏:

* **Questions** ‚Äî –≤–æ–ø—Ä–æ—Å—ã, —Å–æ–∑–¥–∞–≤–∞–µ–º—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏.
* **Answers** ‚Äî –æ—Ç–≤–µ—Ç—ã –∫ –≤–æ–ø—Ä–æ—Å–∞–º.
* **Users** ‚Äî –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Basic Auth, —Å—É—â–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ PostgreSQL.

API –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–ª–Ω—ã–π CRUD-—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:

### Questions

* `POST /questions` ‚Äî —Å–æ–∑–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å
* `GET /questions` ‚Äî —Å–ø–∏—Å–æ–∫ –≤–æ–ø—Ä–æ—Å–æ–≤
* `GET /questions/{id}` ‚Äî –ø–æ–ª—É—á–∏—Ç—å –≤–æ–ø—Ä–æ—Å + –æ—Ç–≤–µ—Ç—ã
* `DELETE /questions/{id}` ‚Äî —É–¥–∞–ª–∏—Ç—å –≤–æ–ø—Ä–æ—Å (+–∫–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤)

### Answers

* `POST /questions/{id}/answers` ‚Äî —Å–æ–∑–¥–∞—Ç—å –æ—Ç–≤–µ—Ç
* `GET /answers/{id}` ‚Äî –ø–æ–ª—É—á–∏—Ç—å –æ—Ç–≤–µ—Ç
* `DELETE /answers/{id}` ‚Äî —É–¥–∞–ª–∏—Ç—å –æ—Ç–≤–µ—Ç

–ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç **–ø–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä —é–Ω–∏—Ç-—Ç–µ—Å—Ç–æ–≤**, **–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤** (repository-tests, infrasuite) –∏ **E2E-—Ç–µ—Å—Ç–æ–≤** (testcontainers + —Ä–µ–∞–ª—å–Ω—ã–π PostgreSQL + HTTP-router + Basic Auth).

---

# üü¶ **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞**

–ü—Ä–æ–µ–∫—Ç —Å–ª–µ–¥—É–µ—Ç –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π –º–Ω–æ–≥–æ—Å–ª–æ–π–Ω–æ–π DDD-–ø–æ–¥–æ–±–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ —Å —á—ë—Ç–∫–æ–π –∏–∑–æ–ª—è—Ü–∏–µ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏:

```
cmd/
internal/
  entity/
  repository/
  usecase/
  rpc/
  infra/
  pkg/
  tests/
migration/
```

## üìå 1. `cmd/` ‚Äî –≤—Ö–æ–¥–Ω–∞—è —Ç–æ—á–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–°–æ–¥–µ—Ä–∂–∏—Ç:

* `cmd/api/main.go` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
* `cmd/router.go` ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è HTTP-–º–∞—Ä—à—Ä—É—Ç–æ–≤, middleware, graceful shutdown

–í—Å—ë, —á—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å–æ —Å—Ç–∞—Ä—Ç–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –æ—Å—Ç–∞—ë—Ç—Å—è –≤ `cmd`.

---

## üìå 2. `internal/entity/` ‚Äî –±–∏–∑–Ω–µ—Å-—Å—É—â–Ω–æ—Å—Ç–∏

–ü—Ä–æ—Å—Ç—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –±–µ–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:

```go
type Question struct {
    ID        int
    UserID    string
    Text      string
    CreatedAt time.Time
}
```

–°–ª–æ–π –Ω–µ –∑–Ω–∞–µ—Ç –Ω–∏ –æ –ë–î, –Ω–∏ –æ HTTP. –û–Ω –∞–±—Å–æ–ª—é—Ç–Ω–æ —á–∏—Å—Ç—ã–π.

---

## üìå 3. `internal/repository/` ‚Äî —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è DAL (Data Access Layer)

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **GORM** –∫–∞–∫ –ø—Ä–æ—Å—Ç–æ–π ORM –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞.

–ö–∞–∂–¥–∞—è —Å—É—â–Ω–æ—Å—Ç—å –∏–º–µ–µ—Ç —Å–≤–æ–π –ø–∞–∫–µ—Ç:

```
repository/
  question/
  answer/
  user/
```

–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

* –ü–æ–ª–Ω–∞—è –∏–∑–æ–ª—è—Ü–∏—è SQL-–ª–æ–≥–∏–∫–∏
* –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –º–µ–∂–¥—É `entity` –∏ —Ç–∞–±–ª–∏—Ü–∞–º–∏
* –¢–µ—Å—Ç—ã –Ω–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ —á–µ—Ä–µ–∑ DB-Suite (—Ä–µ–∞–ª—å–Ω–∞—è PostgreSQL –ø–æ–¥–Ω–∏–º–∞–µ—Ç—Å—è testcontainers)

---

## üìå 4. `internal/usecase/` ‚Äî –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (Application Layer)

–í use-case —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –ª–æ–≥–∏–∫–∞:

* –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
* –≤–∞–ª–∏–¥–∞—Ü–∏—è (–º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è)
* orchestration –º–µ–∂–¥—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è–º–∏
* –≤—ã–∑–æ–≤ UnitOfWork –¥–ª—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
* –≤—ã–∑–æ–≤ —Ç–∞–π–º–µ—Ä–æ–≤, –ª–æ–≥–≥–µ—Ä–æ–≤ –∏ —Ç.–¥.

–ö–∞–∂–¥—ã–π —é–∑–∫–µ–π—Å ‚Äî –º–∞–ª–µ–Ω—å–∫–∏–π –º–æ–¥—É–ª—å:

```
usecase/question/create
usecase/question/delete
usecase/question/get_with_answers
usecase/question/list

usecase/answer/create
usecase/answer/delete
usecase/answer/get_by_id

usecase/auth
```

–ö–∞–∂–¥—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç:

* –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
* —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é
* mocks (mockery)
* usecase-tests

---

## üìå 5. `internal/rpc/` ‚Äî HTTP-—Å–ª–æ–π (transport layer)

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **net/http**, –Ω–∞–ø–∏—Å–∞–Ω—ã –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–µ, —á–∏—Ç–∞–µ–º—ã–µ —Ö–µ–Ω–¥–ª–µ—Ä—ã:

* –º–∏–Ω–∏–º—É–º –ª–æ–≥–∏–∫–∏
* –º–∞–∫—Å–∏–º—É–º –º–∞–ø–ø–∏–Ω–≥–∞ –º–µ–∂–¥—É usecase <-> JSON

–°—Ç—Ä—É–∫—Ç—É—Ä–∞:

```
rpc/
  question/
    create_question/
    delete_question/
    get/
    list/
  answer/
    create/
    delete/
    get/
```

–ö–∞–∂–¥—ã–π handler –∏–º–µ–µ—Ç:

* DTO –¥–ª—è –≤—Ö–æ–¥–∞
* DTO –¥–ª—è –≤—ã—Ö–æ–¥–∞
* –∞–¥–∞–ø—Ç–∞—Ü–∏—é –æ—à–∏–±–æ–∫
* —Ç–µ—Å—Ç—ã —á–µ—Ä–µ–∑ httptest (mock usecase)

### Basic Auth middleware

`internal/pkg/rpc/rpc_auth`:

* –¥–æ—Å—Ç–∞—ë—Ç username/password
* –≤—ã–∑—ã–≤–∞–µ—Ç usecase.Auth
* –ø–∏—à–µ—Ç `c.Set("user_id", ...)`

–õ—é–±–æ–π handler –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å:

```go
uid := rpc.GetUserID(c)
```

---

## üìå 6. `internal/infra/` ‚Äî –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

* –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î
* –º–∏–≥—Ä–∞—Ü–∏–∏ goose
* –∑–∞–≥—Ä—É–∑–∫–∞ env
* slog logger
* –æ–±—â–∏–µ —Ä–µ—Å—É—Ä—Å—ã

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–¥–∏–Ω –æ–±—ä–µ–∫—Ç:

```go
type Resources struct {
    DB     *gorm.DB
    Logger *slog.Logger
    Env    Env
}
```

---

## üìå 7. `internal/pkg/` ‚Äî –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞–∫–µ—Ç—ã

* `rpc/` ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫, JSON bind
* `uow/` ‚Äî Unit Of Work (context-based transaction)
* `timer/` ‚Äî –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤—Ä–µ–º–µ–Ω–∏ (–¥–ª—è —Ç–µ—Å—Ç–æ–≤)

---

## üìå 8. `internal/tests/` ‚Äì —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Ç–µ—Å—Ç–æ–≤–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```
tests/
  dbsuite/
  infrasuite/
  e2esuite/
```

### DB-Suite

–†–µ–∞–ª—å–Ω—ã–π PostgreSQL, –º–∏–≥—Ä–∞—Ü–∏–∏, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ ‚Äî –¥–ª—è —Ç–µ—Å—Ç–æ–≤ repository.

### Infra-Suite

–¢–µ—Å—Ç–∏—Ä—É–µ—Ç –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (–ª–æ–≥–≥–µ—Ä, env loader –∏ —Ç.–¥.).

### E2E-Suite

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç testcontainers:

* –ø–æ–¥–Ω–∏–º–∞–µ—Ç—Å—è PostgreSQL
* –Ω–∞–∫–∞—Ç—ã–≤–∞—é—Ç—Å—è –º–∏–≥—Ä–∞—Ü–∏–∏ goose
* –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Ä–µ–∞–ª—å–Ω—ã–π HTTP-—Å–µ—Ä–≤–µ—Ä —á–µ—Ä–µ–∑ httptest.Server
* —Å–æ–∑–¥–∞—é—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ Bob –∏ Alice
* –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ–ª–Ω—ã–π —Å–∫–≤–æ–∑–Ω–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π

---

# üü© **–ó–æ–ª–æ—Ç–∞—è —Å–µ—Ä–µ–¥–∏–Ω–∞: –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –∫–æ–º–ø—Ä–æ–º–∏—Å—Å**

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —É–º—ã—à–ª–µ–Ω–Ω–æ —Å–¥–µ–ª–∞–Ω –∫–∞–∫ **—á–∏—Å—Ç—ã–π, –º–æ–¥—É–ª—å–Ω—ã–π –º–æ–Ω–æ–ª–∏—Ç**, –∫–æ—Ç–æ—Ä—ã–π:

* –ª–µ–≥–∫–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
* –ª–µ–≥–∫–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –ø–æ —Ñ–∏—á–∞–º
* –∏–º–µ–µ—Ç –Ω–∏–∑–∫—É—é —Å–≤—è–∑–∞–Ω–Ω–æ—Å—Ç—å (low coupling)
* –∏–º–µ–µ—Ç –≤—ã—Å–æ–∫—É—é –∫–æ–≥–µ–∑–∏—é –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —Å–ª–æ—ë–≤ (high cohesion)
* –±—ã—Å—Ç—Ä—ã–µ —Ç–µ—Å—Ç—ã, –≤—ã—Å–æ–∫–∞—è –ø–æ–∫—Ä—ã–≤–∞–µ–º–æ—Å—Ç—å
* —á–∏—Å—Ç—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –º–µ–∂–¥—É —Å–ª–æ—è–º–∏
* –∫–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ

–¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ –ø–æ–∑–≤–æ–ª—è–µ—Ç:

* –±–µ–∑–æ–ø–∞—Å–Ω–æ —Ä–∞—Å—à–∏—Ä—è—Ç—å —Å–∏—Å—Ç–µ–º—É
* –Ω–µ –±–æ—è—Ç—å—Å—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
* –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ usecase-—ã –±–µ–∑ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏—è –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã
* –ª–µ–≥–∫–æ –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã, –µ—Å–ª–∏ —ç—Ç–æ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è

---

# üü® **–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –ø—Ä–æ—â–µ –∏ –¥–µ—à–µ–≤–ª–µ**

–î–ª—è **–º–∏–Ω–∏-–ø—Ä–æ–µ–∫—Ç–∞** —è –±—ã —Å–¥–µ–ª–∞–ª:

‚úî PostgreSQL
‚úî `postgREST`
‚úî Nginx reverse proxy
‚úî –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ JWT –Ω–∞ proxy
‚úî –Ω–∏–∫–∞–∫–æ–≥–æ Go-backend —Å–æ–≤—Å–µ–º

–≠—Ç–æ –¥–µ—à—ë–≤—ã–π, –Ω–∞–¥—ë–∂–Ω—ã–π, –±—ã—Å—Ç—Ä—ã–π –∏ production-ready –≤–∞—Ä–∏–∞–Ω—Ç –ø—Ä–∏–º–µ—Ä–Ω–æ –∑–∞ 1 —á–∞—Å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.

---

# üü• **–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –º–æ—â–Ω–µ–µ, –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–µ–µ –∏ –ø–æ–¥ —Ä–µ–∞–ª—å–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É**

–Ø –±—ã:

* –æ—Ç–∫–∞–∑–∞–ª—Å—è –æ—Ç GORM ‚Üí **pgxpool**
* —Ä–∞–∑–¥–µ–ª–∏–ª —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –Ω–∞ **read / write**
* –≤–≤—ë–ª **—Ä–µ–ø–ª–∏–∫—É PostgreSQL**
* —Å–¥–µ–ª–∞–ª **–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: Prometheus + Grafana + pgbouncer metrics
* —à–∞—Ä–¥–∏—Ä–æ–≤–∞–ª —Ç–∞–±–ª–∏—Ü—ã (–ø–æ user_id –∏–ª–∏ –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º –¥–∞—Ç)
* –¥–æ–±–∞–≤–∏–ª **partitioning** –≤ –º–∏–≥—Ä–∞—Ü–∏–∏
* —Å–¥–µ–ª–∞–ª —Ä—É—á–Ω–æ–µ SQL (–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –ø–æ CPU –∏ IO)
* –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª pgx.Batch –∏ CopyFrom –¥–ª—è –º–∞—Å—Å–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
* –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ: Redis / Ristretto
* –≤–≤—ë–ª rate-limit, circuit breaker
* –¥–æ–±–∞–≤–∏–ª API-–≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

–¢–∞–∫–æ–π –º–æ–Ω–æ–ª–∏—Ç —É–∂–µ —Ç—è–Ω–µ—Ç —Å–æ—Ç–Ω–∏ —Ç—ã—Å—è—á RPS.

---

# üü™ **–í—ã–≤–æ–¥**

–ü—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç:

* –∑—Ä–µ–ª—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É
* —Ç–µ—Å—Ç–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥ enterprise-—É—Ä–æ–≤–Ω—è
* —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–ª–æ—ë–≤ –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
* –º–æ–¥—É–ª—å–Ω–æ—Å—Ç—å
* –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å
* —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å –Ω–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö
* –ø—Ä–æ–¥—É–º–∞–Ω–Ω—ã–µ trade-offs
